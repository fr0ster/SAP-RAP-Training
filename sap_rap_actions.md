# üìÖ –†–æ–∑—à–∏—Ä–µ–Ω–∏–π –∫–æ–Ω—Å–ø–µ–∫—Ç: Actions –≤ SAP RAP (Markdown, üá∫üá¶)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ / –ó–º—ñ—Å—Ç (TOC)

- [–©–æ —Ç–∞–∫–µ Action —É RAP?](#-—â–æ-—Ç–∞–∫–µ-action-–≤-sap-rap)
- [–¢–∏–ø–∏ Actions](#-—Ç–∏–ø–∏-actions)
- [–¢–∏–ø–∏ —ñ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—ó Actions](#-—Ç–∏–ø–∏-—ñ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—ó-actions)
- [–û–≥–æ–ª–æ—à–µ–Ω–Ω—è Actions –≤ Behavior Definition](#-–æ–≥–æ–ª–æ—à–µ–Ω–Ω—è-actions-–≤-behavior-definition)
- [–Ü–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—è Actions —É Behavior Implementation](#-—ñ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—è-actions-—É-behavior-implementation)
- [–¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π–Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ Actions](#-—Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π–Ω–∞-–ø–æ–≤–µ–¥—ñ–Ω–∫–∞-actions)
- [Actions —É —á–µ—Ä–Ω–µ—Ç–∫–æ–≤–∏—Ö –æ–±'—î–∫—Ç–∞—Ö](#-actions-—É-—á–µ—Ä–Ω–µ—Ç–∫–æ–≤–∏—Ö-–æ–±'—î–∫—Ç–∞—Ö)
- [–í–∞–ª—ñ–¥–∞—Ü—ñ—è Actions](#-–≤–∞–ª—ñ–¥–∞—Ü—ñ—è-actions)
- [–ö—Ä–∞—â—ñ –ø—Ä–∞–∫—Ç–∏–∫–∏](#-–∫—Ä–∞—â—ñ-–ø—Ä–∞–∫—Ç–∏–∫–∏)

### üí™ –©–æ —Ç–∞–∫–µ Action –≤ SAP RAP

**Action** ‚Äî —Ü–µ –æ–∫—Ä–µ–º–∞ –±—ñ–∑–Ω–µ—Å-–æ–ø–µ—Ä–∞—Ü—ñ—è, —è–∫–∞ –≤–∏–∫–æ–Ω—É—î –∑–º—ñ–Ω—É —Å—Ç–∞–Ω—É –∞–±–æ –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ Business Object –ø–æ–∑–∞ –º–µ–∂–∞–º–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö CRUD-–æ–ø–µ—Ä–∞—Ü—ñ–π (Create, Read, Update, Delete, Lock).

–ù–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π, Actions –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è:

- –∑–º—ñ–Ω–∏ —Å—Ç–∞—Ç—É—Å—É –æ–±'—î–∫—Ç–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤ —Ä–µ–∂–∏–º "–û—á—ñ–∫—É–≤–∞–Ω–Ω—è"),
- –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–æ—ó –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –º–∞—Å–æ–≤–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–±–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –¥–µ–∫—ñ–ª—å–∫–æ—Ö –∑–∞–ø–∏—Å—ñ–≤),
- –∑–∞–ø—É—Å–∫—É —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤, –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö, –º–∞—Å–æ–≤–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–∏—Ö –æ–±'—î–∫—Ç—ñ–≤).

> üì¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ CRUD –æ–ø–µ—Ä–∞—Ü—ñ—ó: Read, Create, Update, Delete, Lock ‚Äî –ø—Ä–∞—Ü—é—é—Ç—å —ñ–∑ –±–∞–∑–æ–≤–∏–º —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è–º –∑–∞–ø–∏—Å–∞–º–∏.
> Actions —Ä–æ–∑—à–∏—Ä—é—é—Ç—å —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å –±—ñ–∑–Ω–µ—Å-–æ–±'—î–∫—Ç—ñ–≤ —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó –∑–º—ñ–Ω —Ç–∞ –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö.

> üîç –ü—Ä–∏–∫–ª–∞–¥–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö Actions:
>
> - Set On Hold (–ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤ —Ä–µ–∂–∏–º –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è),
> - Release From Hold (–∑–Ω—è—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∑ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è),
> - Approve (–∑–∞—Ç–≤–µ—Ä–¥–∏—Ç–∏ –∑–∞–ø–∏—Å),
> - Recalculate Pricing (–ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏ —Ü—ñ–Ω–∏).

### üî¢ –¢–∏–ø–∏ Actions

| –¢–∏–ø                   | –û–ø–∏—Å                                                                                                 |
| --------------------- | ---------------------------------------------------------------------------------------------------- |
| **Internal Action**   | –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ª–∏—à–µ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ª–æ–≥—ñ–∫–∏ Business Object, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –≤–∏–∫–ª–∏–∫—ñ–≤.               |
| **Static Action**     | –í–∏–∫–æ–Ω—É—î—Ç—å—Å—è –±–µ–∑ –ø—Ä–∏–≤'—è–∑–∫–∏ –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó —ñ–Ω—Å—Ç–∞–Ω—Ü—ñ—ó, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `%cid` –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –≤–∏–∫–ª–∏–∫—É.  |
| **Repeatable Action** | –î–æ–∑–≤–æ–ª—è—î –±–∞–≥–∞—Ç–æ—Ä–∞–∑–æ–≤–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–ª—è —Ç—ñ—î—ó –∂ —ñ–Ω—Å—Ç–∞–Ω—Ü—ñ—ó –ø—Ä–æ—Ç—è–≥–æ–º –æ–¥–Ω—ñ—î—ó —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `%cid`. |
| **Factory Action**    | –°—Ç–≤–æ—Ä—é—î –Ω–æ–≤—ñ —ñ–Ω—Å—Ç–∞–Ω—Ü—ñ—ó –≤ –ø–∞–º'—è—Ç—ñ –∑ —Ç–∏–º—á–∞—Å–æ–≤–∏–º–∏ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞–º–∏ `%cid`, –±–µ–∑ –Ω–µ–≥–∞–π–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É –≤ –±–∞–∑—É. |
| **Save Action**       | –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è —É —Ñ–∞–∑—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–ª—è —Ñ—ñ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—ó –∑–º—ñ–Ω –ø–µ—Ä–µ–¥ –∫–æ–º—ñ—Ç–æ–º.                       |

> ‚ÑπÔ∏è `%cid` ‚Äî —Ç–∏–º—á–∞—Å–æ–≤–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä —Å—Ç–≤–æ—Ä–µ–Ω–∏—Ö –∞–±–æ –∑–º—ñ–Ω–µ–Ω–∏—Ö –æ–±'—î–∫—Ç—ñ–≤ –ø—ñ–¥ —á–∞—Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –¥–æ –º–æ–º–µ–Ω—Ç—É —ó—Ö —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö. [–î–æ–∫–ª–∞–¥–Ω—ñ—à–µ](https://help.sap.com/docs/abap-cloud/abap-rap/actions#define-actions)

### üë©‚Äçüíª –¢–∏–ø–∏ —ñ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—ó Actions

| –¢–∏–ø —ñ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—ó               | –û–ø–∏—Å                                                                                      |
| ------------------------------- | ----------------------------------------------------------------------------------------- |
| **Instance Action**             | –ü—Ä–∞—Ü—é—î –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—é —ñ–Ω—Å—Ç–∞–Ω—Ü—ñ—î—é —á–µ—Ä–µ–∑ `%key`, –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø—Ä–∏–≤'—è–∑–∞–Ω–∞ –¥–æ —ñ—Å–Ω—É—é—á–æ–≥–æ –∑–∞–ø–∏—Å—É.  |
| **Static Action**               | –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó —ñ–Ω—Å—Ç–∞–Ω—Ü—ñ—ó, `%cid` —Å–ª—É–∂–∏—Ç—å –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó —É —Å–µ—Å—ñ—ó. |
| **Action –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏**        | –ü—Ä–∏–π–º–∞—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É `%param`, —â–æ –º—ñ—Å—Ç–∏—Ç—å –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ Action.          |
| **Action –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–Ω–∏–º —Ç–∏–ø–æ–º** | –°—Ç–≤–æ—Ä—é—î –æ–±'—î–∫—Ç–∏ —É –ø–∞–º'—è—Ç—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `%cid`, —â–æ –±—É–¥—É—Ç—å —Ñ—ñ–∑–∏—á–Ω–æ –∑–∞–ø–∏—Å–∞–Ω—ñ –ø—ñ—Å–ª—è Save.     |
| **Factory Action**              | –ú–∞—Å–æ–≤–æ —Å—Ç–≤–æ—Ä—é—î –Ω–æ–≤—ñ –æ–±'—î–∫—Ç–∏, –∑ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—é –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–≤'—è–∑–∫—ñ–≤ —á–µ—Ä–µ–∑ %param.             |

### üìö –°–ª—É–∂–±–æ–≤—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –≤ SAP RAP Actions

| –°–∏–º–≤–æ–ª | –û–ø–∏—Å | –ü–æ—Å–∏–ª–∞–Ω–Ω—è |
|:-------|:-----|:----------|
| **%cid** | –¢–∏–º—á–∞—Å–æ–≤–∏–π –ª–æ–∫–∞–ª—å–Ω–∏–π ID —Å—Ç–≤–æ—Ä–µ–Ω–æ—ó –∞–±–æ –æ–±—Ä–æ–±–ª–µ–Ω–æ—ó —ñ–Ω—Å—Ç–∞–Ω—Ü—ñ—ó –ø—ñ–¥ —á–∞—Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –¥–æ —ó—ó –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ –±–∞–∑—É. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑–≤'—è–∑–∫—É –º—ñ–∂ –æ–±'—î–∫—Ç–∞–º–∏ –≤ –ø–∞–º'—è—Ç—ñ. | [SAP Help: Working with %cid](https://help.sap.com/docs/abap-cloud/abap-rap/actions#define-actions) |
| **%key** | –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä —ñ—Å–Ω—É—é—á–æ—ó —ñ–Ω—Å—Ç–∞–Ω—Ü—ñ—ó Business Object, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –¥–æ—Å—Ç—É–ø—É –∞–±–æ –∑–º—ñ–Ω–∏ –∑–∞–ø–∏—Å—É –≤ –±–∞–∑—ñ. | [SAP Help: Instance Actions and %key](https://help.sap.com/docs/abap-cloud/abap-rap/actions#instance-and-static-actions) |
| **%param** | –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤, —â–æ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è —É –≤–∏–∫–ª–∏–∫ Action –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö. | [SAP Help: Actions with Parameters](https://help.sap.com/docs/abap-cloud/abap-rap/actions#actions-with-parameters) 

### ‚úèÔ∏è –û–≥–æ–ª–æ—à–µ–Ω–Ω—è Actions –≤ Behavior Definition
```abap
define behavior for ZI_SalesOrder
persistent table ZSalesOrder
lock master
{
  action set_on_hold result [1] $self;
  action release_from_hold result [1] $self;
  static action refresh_all;
}
```

### üõ†Ô∏è –Ü–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—è Actions —É Behavior Implementation
```abap
METHOD set_on_hold.
  LOOP AT keys INTO DATA(ls_key).
    UPDATE zsalesorder
      SET status = 'ON_HOLD'
      WHERE salesorder_id = @ls_key-salesorder_id.
  ENDLOOP.
ENDMETHOD.

METHOD release_from_hold.
  LOOP AT keys INTO DATA(ls_key).
    UPDATE zsalesorder
      SET status = 'RELEASED'
      WHERE salesorder_id = @ls_key-salesorder_id.
  ENDLOOP.
ENDMETHOD.

METHOD refresh_all.
  UPDATE zsalesorder
    SET last_refresh = sy-datum.
ENDMETHOD.
```

### üõ†Ô∏è –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π–Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ Actions
- Actions –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó Save.
- –Ø–∫—â–æ Action –∑–º—ñ–Ω—é—î –¥–∞–Ω—ñ, –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ `result`.
- Save Actions –≤–∏–∫–ª–∏–∫–∞—é—Ç—å—Å—è –ª–∏—à–µ –ø—ñ–¥ —á–∞—Å Save Sequence.

### üìù Actions —É —á–µ—Ä–Ω–µ—Ç–∫–æ–≤–∏—Ö –æ–±'—î–∫—Ç–∞—Ö
```abap
draft action submit result [1] $self;
draft action discard result [1] $self;
```

### üìã –í–∞–ª—ñ–¥–∞—Ü—ñ—è Actions
```abap
define behavior for ZI_SalesOrder
persistent table ZSalesOrder
lock master
{
  action set_on_hold result [1] $self;
  validate action set_on_hold on save { my_validation; }

  action release_from_hold result [1] $self;
  validate action release_from_hold on save { my_validation; }
}
```

### ‚úÖ –ö—Ä–∞—â—ñ –ø—Ä–∞–∫—Ç–∏–∫–∏
| ‚úÖ –ü—Ä–∞–∫—Ç–∏–∫–∞ | üîç –ß–æ–º—É? | üîó –û—Ñ—ñ—Ü—ñ–π–Ω–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è |
|:-----------|:--------|:-----------------------|
| –ó–∞–≤–∂–¥–∏ –ø–æ–≤–µ—Ä—Ç–∞–π—Ç–µ `$self` | –©–æ–± UI –æ–Ω–æ–≤–∏–≤—Å—è –ø—ñ—Å–ª—è –∑–º—ñ–Ω–∏ –æ–±'—î–∫—Ç–∞ | [SAP Help: Actions and $self](https://help.sap.com/docs/abap-cloud/abap-rap/actions#define-actions) |
| –í–∏–∫–æ–Ω—É–π—Ç–µ –±—ñ–∑–Ω–µ—Å-–≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –≤ `validate_action` | –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–∞–Ω—ñ –ø–µ—Ä–µ–¥ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º | [SAP Help: Validations in RAP](https://help.sap.com/docs/abap-cloud/abap-rap/validations) |
| –ù–µ –∑–º—ñ–Ω—é–π—Ç–µ –∫–ª—é—á–æ–≤—ñ –ø–æ–ª—è –±–µ–∑ –ø–æ—Ç—Ä–µ–±–∏ | –ü–æ—Ä—É—à—É—î—Ç—å—Å—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∑–∞–ø–∏—Å—É | [SAP Best Practices: Avoid Updating Key Fields](https://help.sap.com/docs/abap-cloud/abap-rap/behavior-definitions#restrictions) |
| –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ ETag | –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è | [SAP Help: Managing Concurrency with ETags](https://help.sap.com/docs/abap-cloud/abap-rap/concurrency-control#etag) |
| –ö–µ—Ä—É–π—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è–º–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ (ROLLBACK) | –ó–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ –¥–∞–Ω–∏—Ö –ø—Ä–∏ –ø–æ–º–∏–ª–∫–∞—Ö | [SAP Help: Transactional Behavior](https://help.sap.com/docs/abap-cloud/abap-rap/actions#transactional-aspects) |
| –†–æ–∑–¥—ñ–ª—è–π—Ç–µ –ª–æ–≥—ñ–∫—É Draft —ñ Active | –Ü–Ω–∞–∫—à–µ –º–æ–∂–ª–∏–≤—ñ –ø–æ–º–∏–ª–∫–∏ —É —Å—Ç–∞—Ç—É—Å–∞—Ö —ñ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ | [SAP Help: Draft Handling](https://help.sap.com/docs/abap-cloud/abap-rap/draft-capability#draft-actions) |

---

# üìÖ Extended Summary: Actions in SAP RAP (Markdown, üá¨üáß)

## Table of Contents (TOC)

- [What is an Action in RAP?](#-what-is-an-action-in-sap-rap)
- [Action Types](#-action-types)
- [Action Implementation Types](#-action-implementation-types)
- [Defining Actions in Behavior Definition](#-defining-actions-in-behavior-definition)
- [Implementing Actions in Behavior Implementation](#-implementing-actions-in-behavior-implementation)
- [Transactional Behavior of Actions](#-transactional-behavior-of-actions)
- [Draft-enabled Actions](#-draft-enabled-actions)
- [Action Validations](#-action-validations)
- [Best Practices](#-best-practices)

### üí™ What is an Action in SAP RAP
An **Action** is an explicit business operation that changes the state or structure of a Business Object, which cannot be realized through standard Create, Read, Update, Delete, or Lock operations.

Actions are used for:
- changing the status of an object (e.g., set an order "On Hold"),
- executing specific business logic or complex processing procedures (e.g., price recalculation, approval workflows),
- initiating mass or conditional changes that go beyond simple record creation or modification.

> üì¢ Standard CRUD operations: Read, Create, Update, Delete, Lock ‚Äî handle basic record management.
> Actions extend object capabilities to support specific business scenarios.

> üîç Example Actions:
> - Set On Hold (set order to waiting mode)
> - Release From Hold (remove order from hold)
> - Approve (approve an object)
> - Recalculate Pricing (recalculate prices based on new conditions)

### üî¢ Action Types
| Type | Description |
|:-----|:------------|
| **Internal Action** | Triggered only within the Business Object logic, not available for external calls. |
| **Static Action** | Executed without reference to a specific instance, uses `%cid` for call identification. |
| **Repeatable Action** | Allows multiple executions on the same instance during a transaction using `%cid`. |
| **Factory Action** | Creates new instances in memory with temporary `%cid` identifiers, without immediate database persistence. |
| **Save Action** | Automatically triggered during the save phase to finalize changes before commit. |

> ‚ÑπÔ∏è `%cid` ‚Äî Temporary identifier for objects created or modified during a transaction before database persistence. [More Details](https://help.sap.com/docs/abap-cloud/abap-rap/actions#define-actions)

### üë©‚Äçüíª Action Implementation Types
| Implementation Type | Description |
|:---------------------|:------------|
| **Instance Action** | Works with a specific instance via `%key`, must be tied to an existing record. |
| **Static Action** | Triggered without reference to a specific instance; `%cid` identifies the operation within the session. |
| **Action with Parameters** | Accepts a `%param` structure containing input data for processing. |
| **Action with Result Type Entity** | Creates new objects in memory with `%cid`, which will be persisted after Save. |
| **Factory Action** | Mass-creates new objects, allowing relation setup through `%cid_ref`. |

### üìö Special Parameters in SAP RAP Actions
| Symbol | Description | Link |
|:-------|:------------|:-----|
| **%cid** | Temporary local ID of an object created or modified during a transaction, used for linking instances in memory. | [SAP Help: Working with %cid](https://help.sap.com/docs/abap-cloud/abap-rap/actions#define-actions) |
| **%key** | Identifier of an existing Business Object instance, used to access or modify database records. | [SAP Help: Instance Actions and %key](https://help.sap.com/docs/abap-cloud/abap-rap/actions#instance-and-static-actions) |
| **%param** | Structure of parameters passed into the Action for additional input data. | [SAP Help: Actions with Parameters](https://help.sap.com/docs/abap-cloud/abap-rap/actions#actions-with-parameters) |

### ‚úèÔ∏è Defining Actions in Behavior Definition
```abap
define behavior for ZI_SalesOrder
persistent table ZSalesOrder
lock master
{
  action set_on_hold result [1] $self;
  action release_from_hold result [1] $self;
  static action refresh_all;
}
```

### üõ†Ô∏è Implementing Actions in Behavior Implementation
```abap
METHOD set_on_hold.
  LOOP AT keys INTO DATA(ls_key).
    UPDATE zsalesorder
      SET status = 'ON_HOLD'
      WHERE salesorder_id = @ls_key-salesorder_id.
  ENDLOOP.
ENDMETHOD.

METHOD release_from_hold.
  LOOP AT keys INTO DATA(ls_key).
    UPDATE zsalesorder
      SET status = 'RELEASED'
      WHERE salesorder_id = @ls_key-salesorder_id.
  ENDLOOP.
ENDMETHOD.

METHOD refresh_all.
  UPDATE zsalesorder
    SET last_refresh = sy-datum.
ENDMETHOD.
```

### üõ†Ô∏è Transactional Behavior of Actions
- Actions are executed within Save transactions.
- If an Action changes data, it must return `result`.
- Save Actions are only triggered during the Save Sequence.

### üìù Draft-enabled Actions
```abap
draft action submit result [1] $self;
draft action discard result [1] $self;
```

### üìã Action Validations
```abap
define behavior for ZI_SalesOrder
persistent table ZSalesOrder
lock master
{
  action set_on_hold result [1] $self;
  validate action set_on_hold on save { my_validation; }

  action release_from_hold result [1] $self;
  validate action release_from_hold on save { my_validation; }
}
```

### ‚úÖ Best Practices
| ‚úÖ Practice | üîç Why? | üîó Official Reference |
|:-----------|:-------|:----------------------|
| Always return `$self` | To refresh UI after object modification | [SAP Help: Actions and $self](https://help.sap.com/docs/abap-cloud/abap-rap/actions#define-actions) |
| Perform validations in `validate_action` | Check business rules before saving | [SAP Help: Validations in RAP](https://help.sap.com/docs/abap-cloud/abap-rap/validations) |
| Avoid modifying key fields unless necessary | To maintain record identity | [SAP Best Practices: Avoid Updating Key Fields](https://help.sap.com/docs/abap-cloud/abap-rap/behavior-definitions#restrictions) |
| Use ETag | Prevent concurrent update conflicts | [SAP Help: Managing Concurrency with ETags](https://help.sap.com/docs/abap-cloud/abap-rap/concurrency-control#etag) |
| Manage transactions properly (ROLLBACK) | Ensure data consistency on errors | [SAP Help: Transactional Behavior](https://help.sap.com/docs/abap-cloud/abap-rap/actions#transactional-aspects) |
| Separate Draft and Active logic | Avoid inconsistencies between drafts and active instances | [SAP Help: Draft Handling](https://help.sap.com/docs/abap-cloud/abap-rap/draft-capability#draft-actions) |

